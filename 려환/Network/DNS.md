## 들어가기 전에 도메인과 호스팅의 차이가 뭔지 아니?

![image](https://github.com/Ryeohwan/TRL/assets/73810834/e7fa8746-199a-4a3d-872e-8b74bd3ea67e)

    간단하게 표현하자면, 도메인은 내 사이트의 이름을 지정하는 것, 호스팅은 내 사이트가 위치하는 공간을 빌리는 것

### 그래서 호스팅이란

내 서버를 구성하는 데이터를 물리적으로 저장할 컴퓨터가 필요한데 이를 직접 호스팅 서버를 구축할 수 있지만 비용이나 사양적인 면에서 호스팅 업체에서 이런 컴퓨터의 공간 일부를 비용을 받고 빌려주는 것을 웹 호스팅이라고 말함.

### 도메인이란

도메인 주소와 호스팅 IP 주소는 아무런 설정이 없는 상태에서는 서로 관련성이 없다. 허지만, 업체에서 별도로 관리하는 외부의 네임서버라는 곳에 A라는 IP 주소는 A’라는 도메인 주소와 같다고 설정을 해주게 되면, 도메인 주소를 통해 IP 주소(=웹사이트)로 접속이 가능해진다.

지금은 ICANN이라는 기관에 편입된 IANA라는 범 국제적인 기관이 조금 더 쓰기 편한 문자로 된 도메인이란 걸 만들고 관리하게 됨

# 개념

    Domain Name System

![image](https://github.com/Ryeohwan/TRL/assets/73810834/8aabc074-678a-4dd5-950e-2978638a1fe9)

- 웹사이트에 접속 할 때 우리는 외우기 어려운 IP 주소 대신 도메인 이름을 사용한다.
  도메인 이름을 사용했을 때 입력한 도메인을 실제 네트워크상에서 사용하는 IP 주소로 바꾸고 해당 IP 주소로 접속하는 과정이 필요하다.
- 이러한 과정, 전체 시스템을 DNS(도메인 네임 시스템)라고 한다.
- 이러한 시스템은 전세계적으로 약속된 규칙을 공유한다.
- 상위 기관에서 인증된 기관에게 도메인을 생성하거나 IP 주소로 변경할 수 있는 ‘권한’을 부여한다.
- DNS는 이처럼 상위 기관과 하위 기관과 같은 ‘계층 구조’를 가지는 분산 데이터베이스 구조를 가진다.

# DNS 서버 종류 구분

![image](https://github.com/Ryeohwan/TRL/assets/73810834/f75c0da3-7f49-48a1-9830-c4183512e041)

1. Root DNS Server
   ICANN이 직접 관리하는 절대 존엄 서버로, TLD DNS 서버 IP들을 저장해두고 안내하는 역할을 함.
2. TLD(최상위 도메인) DNS Server
   도메인 등록 기관(Registry)이 관리하는 서버로, Authoritative DNS 서버 주소를 저장해두고 안내하는 역할을 함. 어떤 도메인 묶음이 어떤 Authoritative DNS Server에 속하는지 아는 이유는 도메인 판매 업체(Registrar)의 DNS 설정이 변경되면 도메인 등록 기관(Registry)으로 전달이 되기 때문임.
3. Authoritative DNS Server
   실제 개인 도메인과 IP 주소의 관계가 기록/저장/변경되는 서버. 그래서 권한의 의미인 Authoritative가 붙음. 일반적으로 도메인/호스팅 업체의 ‘네임서버’를 말하지만, 개인 DNS 서버 구축을 한 경우에도 여기에 해당함.
4. Recursive DNS Server
   인터넷 사용자가 가장 먼저 접근하는 DNS 서버임. 위 3개의 DNS 서버를 매번 거친다면 효율이 구데기일 수밖에 없으니, 한 번 거친 후 얻은 데이터를 일정 기간(TTL/Time to Live) 동안 캐시라는 형태로 저장해 두는 서버임. 직접 도메인과 IP 주소의 관계를 기록/저장/변경하지는 않고 캐시만을 보관하기 때문에, Authoritative와 비교되는 의미로 반복의 Recursive가 붙음. 대표적인게 KT/LG/SK와 같은 ISP(통신사) DNS 서버가 있고, 브라우저 우회 용도로 많이 쓰는 구글 DNS, 클라우드플레어와 같은 Public DNS 서버가 있음.

# 동작 순서

![image](https://github.com/Ryeohwan/TRL/assets/73810834/4fa7df52-d64d-4a9b-bd18-1d590c2728f6)

1. 브라우저에서 Nesite.com을 검색하고, 사용하고 있는 통신사인 KT DNS 서버에게 도메인 주소에 해당하는 IP 주소를 요청함
   (브라우저 기본 DNS 설정이 통신사 DNS 서버이기 때문)

2. ISP 서버에선 캐시 데이터가 없다는 걸 확인하고 루트 DNS 서버에게 어디로 가야 하는지 요청함(캐시가 있다면 8.로 건너 뜀.)

3. 루트 서버는 TLD DNS 서버 주소만 관리하기 때문에, \*\*\*.com 도메인을 보고는 COM 최상위 도메인을 관리하는 TLD DNS 서버 주소를 안내함.

4. ISP 서버는 COM 서버에게 어디로 가야 하는지 다시 요청함.

5. COM 서버는 가비아 DNS 서버에서 해당 도메인이 관리되고 있는 걸 확인하고 안내함.

6. ISP 서버는 가비아 서버에게 또 다시 요청함.

7. 가비아 서버는 “Nesite.com = 12.123.123.123”이라는 정보를 확인하고 이 IP를 알려줌. 동시에 ISP 서버는 해당 정보를 캐시로 기록해 둠.

8. ISP 서버는 브라우저에게 힘들게 알아 낸 12.123.123.123 주소를 안내함.

9. 브라우저는 12.123.123.123 IP 주소를 갖고 있는 호스팅 서버에게 웹사이트를 출력하라고 요청함.

10. 드디어 보임.

# 구성 요소

1. 도메인 네임 스페이스(Domain Name Space)
2. 네임 서버(Name Server) = 권한 있는 DNS 서버
3. 리졸버(Resolver) = 권한 없는 DNS 서버

- 우선 “이 도메인 이름은 이 IP 주소이다”라는 ‘텍스트’를 저장하는 데이터베이스가 필요하다.
  그리고 분산된 데이터가 어디 저장되어 있는지 찾을 프로그램들이 필요하고 찾았으면 해당 IP 주소로 이동할 프로그램(브라우저 등)이 필요하다.
- 도메인 네임 스페이스라는 규칙(방법)으로 도메인 이름 저장을 분산한다.
- 네임 서버(DNS 서버와 같은 말, 그런데 리졸버 서버 등 시스템 안에서 다른 역할을 하는 서버도 있기에 그냥 DNS 서버라고 하는 것보다 네임 서버라고 하는게 더 의미가 전달되는 듯)가 해당 도메인 이름의 IP 주소를 찾는다.
- 리졸버가 DNS 클라이언트 요청을 네임 서버로 전달하고 찾은 정보를 클라이언트에게 제공하는 기능을 수행한다.
- 어떤 네임 서버에서 찾아야하는지, 이미 캐시 되어있는지 등 어떻게든 찾아서 클라이언트에게 찾았으면 찾은 것을 못 찾았으면 못 찾았다고 전달하는 역할을 한다.
- 리졸버는 단말에 구현하는 것은 무리수라 보통은 리졸버가 구현된 네임 서버의 IP 주소만을 파악한다.
- 대표적인 것이 KT/LG/SK와 같은 ISP(통신사) DNS 있고, 브라우저 우회 용도로 많이 쓰는 구글 DNS, 클라우드플레어와 같은 Public DNS 서버가 있다.
- 그래서 거의 Resolver = Recursive DNS Server = Local Server(of ISP) = Recursor
- 어떤 자료에서는 리졸버라는 요소를 생략하기도 한다.

# 이런 구성으로 나뉜 이유

- 물리적으로 엄청난 양의 사이트의 이름들을 관리할 서버가 한 대로는 어렵기 때문이다.
- 네임 서버를 여러 대 만들면 되지 않을까 싶지만 그렇게 되면 도메인과 IP 주소를 모든 서버에서 공유해야 한다. 그렇지 않으면 어떤 네임 서버에서는 특정 사이트에 대해서 (네이버라던지 구글이라던지) 모른다고 할 수 있다.
- 이렇게 때문에 도메인을 계층적으로 구분하는, 정보(도메인과 IP주소)를 분산하는 구조를 선택하게 되었다.
  - 이 구분한 것이 . 이다. 점이 계층을 나타내는 것이다.
